import matplotlib.pyplot as plt
import numpy as np
ph =[13,10,8,7]
# strain_hor = np.array([0.036,0.028,0.044,0.073])
# strain_ver =np.array([0.25,0.26,0.33,0.35])
# size_hor =np.array([0.87,0.81,0.63,0.78])
# size_ver = np.array([0.86,0.89,0.62,0.73])
strain_hor = np.array([0.0319,0.0236,0.0487,0.0829])
strain_hor_err = np.array([0.006,0.008,0.015,0.013])
strain_ver =np.array([0.257,0.271,0.342,0.373])
strain_ver_err =np.array([0.017,0.019,0.0257,0.0169])
size_hor =np.array([0.48,0.524,0.637,0.646])
size_hor_err =np.array([0.09,0.085,0.098,0.1])
size_ver = np.array([0.679,0.689,0.705,0.763])
size_ver_err = np.array([0.06,0.0572,0.062,0.006])
fig= plt.figure(figsize=(8,4))
ax1=fig.add_subplot(121)
# ax1.errorbar(ph,396*strain_hor**2*strain_ver,yerr=396*strain_hor_err**2*strain_ver_err,color='blue',marker='o',label = 'unit cell volumne change')
ax1.errorbar(ph,strain_ver,yerr=np.array([0.017,0.019,0.0257,0.0169]),color ='r',marker='o',label = 'vertical strain')
ax1.errorbar(ph,strain_hor,yerr=strain_hor_err,color ='blue',marker='o',label = 'horizontal strain')
plt.legend()
ax1.set_xlabel('pH')
ax1.set_ylabel('strain change rate(%/V)')
# ax2 = ax1.twinx()
ax2=fig.add_subplot(122)
ax2.set_xlabel('pH')
# ax2.plot(ph,size_hor**2*size_ver,color ='blue',marker ='o',label = 'horizontal size')
ax2.errorbar(ph,size_ver,yerr=[0.06,0.057,0.062,0.06],color ='r',marker ='o',label = 'vertical size')
ax2.errorbar(ph,size_hor,yerr=size_hor_err,color ='blue',marker ='o',label = 'horizontal size')
ax2.set_ylabel('size change rate(nm/V)')
plt.legend()
plt.tight_layout()
plt.savefig("temp.png",dpi=300)
plt.show()
